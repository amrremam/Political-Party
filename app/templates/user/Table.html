{% extends 'base.html' %}
{% load static %}

{% block body %}
    

<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>بيانات الأعضاء</title>
    <!-- Add these lines in the head of your HTML file -->
    <script src="https://rawgit.com/eKoopmans/html2pdf/master/dist/html2pdf.bundle.js"></script>
    <script src="https://cdn.rawgit.com/eKoopmans/html2pdf/master/dist/html2pdf.bundle.js"></script>


    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f8f9fa;
            margin: 20px;
        }

        h1 {
            font-size: 36px;
            color: #000000;
            font-weight: bold;
            text-align: center; /* Center the title */
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        th, td {
            padding: 10px;
            text-align: center;
        }

        th {
            background-color: #ffffff;
        }

        tr {
            background-color: #ffffff;
            border-bottom: 2px solid #dee2e6;
            border-radius: 5px;
            margin-bottom: 10px;
        }

        .edit-btn, .delete-btn {
            padding: 5px 10px;
            border: none;
            cursor: pointer;
            margin-right: 5px;
            border-radius: 5px;
        }

        .edit-btn {
            background-color: #28a745;
            color: #ffffff;
        }

        .delete-btn {
            background-color: #dc3545;
            color: #ffffff;
        }

        .search-bar {
            float: right;
        }

        .add-user-btn {
            float: left;
            background-color: #000000;
            color: #ffffff;
            padding: 10px;
            border: none;
            cursor: pointer;
            border-radius: 5px;
        }

        .export-buttons {
            float: left;
            margin-top: 20px;
        }

        .export-btn {
            background-color: #000000;
            color: #ffffff;
            padding: 10px;
            border: none;
            margin-right: 10px;
            cursor: pointer;
            border-radius: 5px;
        }
    </style>
</head>
<body dir="rtl">

<h1>بيانات الأعضاء</h1>

{#<input type="text" class="search-bar" placeholder="البحث...">#}
<div class="input-group">
    <input type="text" class="form-control search-bar" placeholder="البحث..." id="search-input">
    <div class="input-group-append">
        <button class="btn btn-dark" type="button" onclick="searchMembers()">ابحث</button>
    </div>
</div>

<!-- Container to display search results -->
<div id="search-results"></div>

<!-- Your table goes here -->
<table id="your-table-id">
    <!-- Your table rows and columns -->
</table>


<a class="add-user-btn" href="{% url 'app:roles' %}">اضافة مستخدم جديد</a>

<table>
    <thead>
        <tr>
            <th></th>
            <th>الرقم التسلسلي</th>
            <th>الاسم</th>
            <th>البريد الإلكتروني</th>
            <th>الدور</th>
            <th>الحالة</th>
            <th>تاريخ الإنشاء</th>
            <th>الإجراءات</th>
        </tr>
    </thead>
    <tbody>
        {% for user in users %}
            <tr>
                <td><input type="checkbox"></td>
                <td>{{ user.id }}</td>
                <td><a href="{% url 'addUser:user_profile' user.id %}">{{ user.name }}</a></td>
{#                <td>{{ user.name }}</td>#}
                <td>{{ user.email }}</td>
                <td>{{ user.partyde }}</td>
                <td>{{ user.status }}</td>
                <td>{{ user.created_at }}</td>
                <td>
                    <a href="{% url 'addUser:update_user' user.id %}" class="edit-btn">تحديث</a>
                    <form method="POST" action="{% url 'addUser:delete_user' user.id %}">
                        {% csrf_token %}
                        <button type="submit" class="delete-btn">حذف</button>
                    </form>
                </td>
            </tr>
        {% endfor %}
    </tbody>
</table>

<div class="export-buttons">
    <button class="export-btn" onclick="printTable()">Print</button>
    <button class="export-btn" onclick="exportToPdf()">PDF</button>
    <button class="export-btn" onclick="exportToCsv()">CSV</button>
{#    <button class="export-btn" onclick="copyTable()">COPY</button>#}
{#    <button class="export-btn">رؤية الأعمدة</button>#}
</div>

<script>
    
    function searchMembers() {
        var keyword = document.getElementById('search-input').value;

        var xhr = new XMLHttpRequest();
        xhr.open('GET', '{% url 'addUser:search_members' %}?keyword=' + keyword, true);

        xhr.onreadystatechange = function() {
            if (xhr.readyState == 4 && xhr.status == 200) {
                document.getElementById('search-results').innerHTML = xhr.responseText;
            }
        };

        xhr.send();
    }
    
    
    function displaySearchResults(results) {
    var searchResultsContainer = document.getElementById('search-results');
    searchResultsContainer.innerHTML = '';

    results.forEach(function(result) {
        var resultElement = document.createElement('div');
        resultElement.innerHTML = 'ID: ' + result.id + ', Name: ' + result.name + ', Email: ' + result.email;
        searchResultsContainer.appendChild(resultElement);
    });
}
</script>


<script>
    function printTable() {
        window.print();
    }

    function exportToPdf() {
        var element = document.getElementById('table-container');
        html2pdf(element);
    }

    function exportToCsv() {
        var csvContent = "data:text/csv;charset=utf-8,";
        var rows = document.querySelectorAll('table tr');

        rows.forEach(function(row) {
            var rowData = [];
            var cols = row.querySelectorAll('td, th');
            cols.forEach(function(col) {
                rowData.push(col.innerText);
            });
            csvContent += rowData.join(',') + '\n';
        });

        var encodedUri = encodeURI(csvContent);
        var link = document.createElement("a");
        link.setAttribute("href", encodedUri);
        link.setAttribute("download", "table.csv");
        document.body.appendChild(link);
        link.click();
    }

    {#function copyTable() {#}
    {#    var table = document.getElementById('data-table');#}
    {#    var rows = table.querySelectorAll('tr');#}
    {#    var copiedText = '';#}
    {##}
    {#    rows.forEach(function(row) {#}
    {#        var cols = row.querySelectorAll('td, th');#}
    {#        cols.forEach(function(col) {#}
    {#            copiedText += col.innerText + '\t'; // Use '\t' for tab-separated values#}
    {#        });#}
    {#        copiedText += '\n';#}
    {#    });#}
    {##}
    {#    navigator.clipboard.writeText(copiedText).then(function() {#}
    {#        alert('Table copied to clipboard');#}
    {#    }).catch(function(err) {#}
    {#        console.error('Unable to copy text to clipboard', err);#}
    {#    });#}
    //}
</script>


</body>
</html>

{% endblock body %}
